# vim: filetype=zsh

# apply LS_COLORS
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"
# cycle through menu on multiple matches with incremental search
#zstyle ':completion:*' menu select search
zstyle ':completion:*:*:*:default' menu select search
# group results by type (files, dirs, etc.)
zstyle ':completion:*' group-name ''
# display descriptions like “(directory)” inline
zstyle ':completion:*:descriptions' format '%F{blue}-- %d:%f'

# try load completions
completions_locations="
    ${HOMEBREW_PREFIX:+$HOMEBREW_PREFIX/share/zsh-completions}
    ${HOMEBREW_PREFIX:+$HOMEBREW_PREFIX/share/zsh/site-functions}
    $_ENV_CONFIG_DIR/zsh/zsh-completions
"
for d in $completions_locations; do
    [[ -d $d ]] && fpath=($d $fpath)
done
unset d
unset completion_locations

# completions
autoload -Uz compinit
compinit -u
# block later re-init
compinit() { return 0 }

# bash completions
autoload -Uz bashcompinit
bashcompinit -u
# block later re-init
bashcompinit() { return 0 }

#for dir in \
#  /etc/profile.d \
#  ${HOMEBREW_PREFIX:+$HOMEBREW_PREFIX/etc/profile.d} \
#  /usr/share/bash-completion/completions \
#  /usr/local/share/bash-completion/completions \
#  /opt/local/etc/profile.d
#do
#  _env_source "$d/bash_completion.sh"
#done
#_env_source "$HOME"/.bash_completion.d/* "$_ENV_CONFIG_DIR"/bash/bash_completions/*

