"use strict";const ht=require("@codemirror/state"),t=require("@lezer/highlight"),b=require("markedit-api"),z=require("@codemirror/view"),S=require("@codemirror/language"),J=window,ft=J.__extractStyleRules__??(e=>e.value?.rules),pt=J.__extractHighlightSpecs__??(e=>e.value?.specs);function bt(e){const n=document.createElement("style");return n.textContent=e,document.head.appendChild(n),n}function kt(e){if(e.length===0)return[{},[]];const n=w(e);return[Object.fromEntries(n.flatMap(r=>{const a=ft(r)?.join(`
`)??"";return Object.entries(yt(a))})),n.flatMap(r=>pt(r)??[])]}function p(e,n,c){return e.find(r=>!!(r.tag.toString().includes(n.toString())&&r.color!==void 0))?.color??c}function E(e,n,c){for(const[r,a]of Object.entries(e))if(r.includes(n)&&(c===void 0||!r.includes(c))){const o=a.background??a.backgroundColor;if(o!==void 0)return o}}function T(e,n=.6){const c=e.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(c===null)return;const[r,a,o]=c.slice(1,4).map(Number);return`rgba(${r}, ${a}, ${o}, ${n})`}function Q(e){const n=a=>a!==null&&typeof a=="object";if(!n(e))return!0;const c=Object.entries(e),r=a=>a!=null;for(const[,a]of c)if(n(a)){if(!Q(a))return!1}else if(r(a))return!1;return!0}function w(e){return Array.isArray(e)?e.flatMap(w):"extension"in e?w(e.extension):[e]}function yt(e){const n={},c=new CSSStyleSheet;c.replaceSync(e);for(const r of c.cssRules){const{style:a,selectorText:o}=r,{background:l,backgroundColor:u}=a;n[o]={},l.length>0&&(n[o].background=l),u.length>0&&(n[o].backgroundColor=u)}return n}const N=(e,n={})=>e??n,Ct=N(b.MarkEdit.userSettings),I=X("extension.markeditTheming"),vt=$(!1)?N(I.lightTheme):void 0,xt=$(!0)?N(I.darkTheme):void 0;function X(e){return e===void 0?{}:N(Ct[e])}function Y(e){return e.enabledMode??"both"}function $(e,n=Y(I)){return["both",e?"dark":"light"].includes(n)}function Tt(e,n,c){const r=Bt({lhs:c,rhs:e?xt:vt});return w(n??[]).forEach(o=>{const l=o;l.value&&Array.isArray(l.value?.rules)&&(l.value.rules=l.value?.rules.filter(u=>!`${u}`.includes(".cm-tooltip")))}),{extensions:[...e?G(r,{dark:!0}):G(r),n].filter(o=>o!==void 0),colors:r}}function G(e,n){const c={},r=[],a=e.editor,o=e.highlight;a?.textColor&&(c["&"]??={},c["&"].color=a?.textColor,c[".cm-activeLineGutter"]={backgroundColor:a?.textColor}),a?.backgroundColor&&(c["&"]??={},c["&"].backgroundColor=a?.backgroundColor),a?.activeLineBackground&&(c[".cm-activeLine"]={backgroundColor:a?.activeLineBackground}),a?.caretColor&&(c[".cm-content"]={caretColor:a?.caretColor},c[".cm-cursor, .cm-dropCursor"]={borderLeftColor:a?.caretColor}),a?.selectionBackground&&(c["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:a?.selectionBackground}),a?.matchingBracketBackground&&(c["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:a?.matchingBracketBackground}),a?.gutterText&&(c[".cm-gutters"]??={},c[".cm-gutters"].color=a?.gutterText),a?.gutterBackground&&(c[".cm-gutters"]??={},c[".cm-gutters"].backgroundColor=a?.gutterBackground,c[".cm-gutters"].border="none"),a?.foldPlaceholderText&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].color=a?.foldPlaceholderText),a?.foldPlaceholderBackground&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].backgroundColor=a?.foldPlaceholderBackground,c[".cm-foldPlaceholder"].border="none"),a?.searchMatchBackground&&(c[".cm-searchMatch"]={backgroundColor:a?.searchMatchBackground}),a?.selectionMatchBackground&&(c[".cm-selectionMatch"]={backgroundColor:a?.selectionMatchBackground}),o?.heading&&r.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&r.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&r.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&r.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&r.push({tag:t.tags.quote,color:o?.quote}),o?.link&&r.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.divider&&r.push({tag:t.tags.contentSeparator,color:o?.divider}),o?.comment&&r.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&r.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&r.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&r.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&r.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&r.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&r.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&r.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&r.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&r.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&r.push({tag:t.tags.className,color:o?.class}),o?.macro&&r.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&r.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&r.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&r.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&r.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&r.push({tag:[t.tags.separator,t.tags.processingInstruction,t.tags.definition(t.tags.name)],color:o?.instruction}),o?.invalid&&r.push({tag:t.tags.invalid,color:o?.invalid});const l=[];return Object.keys(c).length>0&&l.push(z.EditorView.theme(c,n)),r.length>0&&l.push(S.syntaxHighlighting(S.HighlightStyle.define(r))),l}function Bt(e){return{editor:{...e.lhs?.editor,...e.rhs?.editor},highlight:{...e.lhs?.highlight,...e.rhs?.highlight},allowsFallback:e.rhs?.allowsFallback??e.lhs?.allowsFallback}}const s={selectionBackground:".cm-selectionBackground",primaryText:".cm-lineNumbers > .cm-activeLineGutter, .cm-tooltip-autocomplete ul li, .cm-tooltip-autocomplete ul li[aria-selected]",secondaryText:".cm-foldGutter, .cm-foldPlaceholder, .cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo, .cm-completionMatchedText",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark, .cm-md-bold.tok-meta, .cm-md-italic.tok-meta, .cm-md-strikethrough.tok-meta",boldText:".cm-md-bold:not(.tok-meta)",italicText:".cm-md-italic:not(.tok-meta)",quoteText:".cm-md-quote:not(.cm-md-quoteMark)",dividerColor:".cm-md-horizontalRule",autocomplete:".cm-tooltip-autocomplete",autocompleteHighlight:".cm-tooltip-autocomplete ul li[aria-selected]"},Mt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.primaryText} {}
${s.secondaryText} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.accentColor} {}
${s.syntaxMarker} {}
${s.boldText} {}
${s.italicText} {}
${s.quoteText} {}
${s.dividerColor} {}
${s.autocomplete} {}
${s.autocompleteHighlight} {}
`;function St(e){const n=e.options?.settingsKey,c=Y(X(n));e.light!==void 0&&$(!1,c)&&(i().customThemes.light=e.light),e.dark!==void 0&&$(!0,c)&&(i().customThemes.dark=e.dark),typeof b.MarkEdit.editorView=="object"&&H(b.MarkEdit.editorView)}const M=window,i=()=>M.__markeditTheming__,Z=matchMedia("(prefers-color-scheme: dark)");typeof i()!="object"&&wt();function wt(){M.__markeditTheming__={styleSheet:bt(Mt),configurator:new ht.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},b.MarkEdit.addExtension(i().configurator.of([])),b.MarkEdit.onEditorReady(n=>H(n));const e=()=>setTimeout(()=>H(b.MarkEdit.editorView),200);Z.addEventListener("change",e),i().mainThemeName=M.config.theme,Object.defineProperty(M.config,"theme",{get(){return i().mainThemeName},set(n){i().mainThemeName=n,e()}})}function H(e){const n=Z.matches,c=n?i().customThemes.dark:i().customThemes.light,{extensions:r,colors:a}=Tt(n,c?.extension,c?.colors);e.dispatch({effects:i().configurator.reconfigure(r)});const[o,l]=kt(r),u=r.length===0&&Q(a),v=a.allowsFallback??c?.extension!==void 0;i().styleSheet.disabled=u,$t(e,n,u,o,l,a,v)}function $t(e,n,c,r,a,o,l){const u=E(r,".cm-activeLine",".cm-activeLineGutter"),v=E(r,s.selectionBackground),et=E(r,s.matchingBracket),at=getComputedStyle(e.dom).backgroundColor,y=getComputedStyle(e.contentDOM).color,rt=o.editor?.visibleSpaceColor??T(y),f=l?y:void 0,A=p(a,t.tags.heading,f),ct=p(a,t.tags.processingInstruction,f),nt=p(a,t.tags.strong,f),st=p(a,t.tags.emphasis,f),lt=p(a,t.tags.quote,f),it=p(a,t.tags.contentSeparator,f),gt=[[s.activeIndicator,u,"background"],[s.matchingBracket,et,"background"],[s.primaryText,y,"color"],[s.secondaryText,rt,"color"],[s.accentColor,A,"color"],[s.syntaxMarker,ct,"color"],[s.boldText,nt,"color"],[s.italicText,st,"color"],[s.quoteText,lt,"color"],[s.dividerColor,it,"color"],[s.autocomplete,T(at),"background"],[s.autocomplete,`1px solid ${T(y,.3)}`,"border"],[s.autocompleteHighlight,T(y,.1),"background"]],dt=Array.from(document.querySelectorAll("style")),x=n?i().darkOriginalRules:i().lightOriginalRules;for(const ut of dt){const q=ut.sheet?.cssRules;if(q!==void 0)for(let P=0;P<q.length;++P){const g=q[P],m=g.selectorText??"";m.includes(".cm-focused")&&m.includes(s.selectionBackground)&&(x.selectionBackground??=g.cssText,c?g.cssText=x.selectionBackground:v!==void 0&&g.style.setProperty("background",v,"important")),A!==void 0&&(m===".cm-md-header"||m===".cm-md-header:not(.cm-md-quote)")&&(x.markdownHeader??=g.cssText,c?g.cssText=x.markdownHeader:g.style.removeProperty("color"));for(const[mt,V,F]of gt)m===mt&&(V===void 0?g.style.removeProperty(F):(g.style.setProperty(F,V,"important"),(m===s.matchingBracket||m===s.activeIndicator)&&g.style.setProperty("box-shadow","unset","important")))}}}const R="#2e3440",tt="#3b4252",ot="#434c5e",k="#4c566a",C="#d8dee9",Nt="#e5e9f0",qt="#eceff4",h="#8fbcbb",W="#88c0d0",Pt="#81a1c1",d="#5e81ac",Et="#bf616a",D="#d08770",L="#ebcb8b",B="#a3be8c",_="#b48ead",K="#d30102",Lt="#252a33",O=k,_t=R,j=tt,Ot=k,U=C,jt=z.EditorView.theme({"&":{color:C,backgroundColor:_t},".cm-content":{caretColor:U},".cm-cursor, .cm-dropCursor":{borderLeftColor:U},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Ot},".cm-panels":{backgroundColor:Lt,color:k},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"transparent",outline:`1px solid ${h}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:C,color:R},".cm-activeLine":{backgroundColor:O},".cm-selectionMatch":{backgroundColor:Nt,color:tt},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${h}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:qt,color:ot},".cm-gutters":{backgroundColor:R,color:k,border:"none"},".cm-activeLineGutter":{backgroundColor:O,color:C},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:j},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:j,borderBottomColor:j},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:O,color:k}}},{dark:!0}),Ht=S.HighlightStyle.define([{tag:t.tags.keyword,color:d},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:W},{tag:[t.tags.variableName],color:h},{tag:[t.tags.function(t.tags.variableName)],color:h},{tag:[t.tags.labelName],color:Pt},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:d},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:B},{tag:[t.tags.brace],color:h},{tag:[t.tags.annotation],color:K},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:_},{tag:[t.tags.typeName,t.tags.className],color:L},{tag:[t.tags.operator,t.tags.operatorKeyword],color:B},{tag:[t.tags.tagName],color:_},{tag:[t.tags.squareBracket],color:Et},{tag:[t.tags.angleBracket],color:D},{tag:[t.tags.attributeName],color:L},{tag:[t.tags.regexp],color:d},{tag:[t.tags.quote],color:_},{tag:[t.tags.string],color:B},{tag:t.tags.link,color:B,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:h},{tag:[t.tags.meta],color:W},{tag:[t.tags.monospace],color:C,fontStyle:"italic"},{tag:[t.tags.comment],color:k,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:d},{tag:t.tags.emphasis,fontStyle:"italic",color:d},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:d},{tag:t.tags.special(t.tags.heading1),fontWeight:"bold",color:d},{tag:t.tags.heading1,fontWeight:"bold",color:d},{tag:[t.tags.heading2,t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:d},{tag:[t.tags.heading5,t.tags.heading6],color:d},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:D},{tag:[t.tags.processingInstruction,t.tags.inserted],color:h},{tag:[t.tags.contentSeparator],color:L},{tag:t.tags.invalid,color:ot,borderBottom:`1px dotted ${K}`}]),Rt=[jt,S.syntaxHighlighting(Ht)];St({dark:{extension:Rt}});
