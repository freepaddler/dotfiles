"use strict";const s=require("@codemirror/view"),c=require("@codemirror/language"),h=require("@codemirror/state"),g=require("markedit-api"),l={resolve:"TextHighlight",mark:"TextHighlight"},u={defineNodes:["TextHighlight","TextHighlightMark"],parseInline:[{name:"TextHighlight",parse:(e,i,t)=>i!=61||e.char(t+1)!=61?-1:e.addDelimiter(l,t,t+2,!0,!0),after:"Emphasis"}]},m=s.ViewPlugin.fromClass(class{},{provide:()=>s.EditorView.decorations.of(e=>{const i=[];for(const{from:t,to:n}of e.visibleRanges)c.syntaxTree(e.state).iterate({from:t,to:n,enter:r=>{if(r.name!=="TextHighlight")return;const a=s.Decoration.mark({class:"cm-md-textHighlight"});i.push(a.range(r.from,r.to))}});return s.Decoration.set(i.sort((t,n)=>t.from-n.from))})}),d=s.EditorView.inputHandler.of((e,i,t,n)=>n==="="&&p(e)?f(n,e):!1);function f(e,i){return i.dispatch(i.state.changeByRange(({from:t,to:n})=>{const r=i.state.sliceDoc(t,n),a=t===n?e:`${e}${r}${e}`,o=t+e.length;return{range:h.EditorSelection.range(o,o+r.length),changes:{from:t,to:n,insert:a}}})),!0}function p(e){return[...e.state.selection.ranges].some(i=>!i.empty)}const x=s.EditorView.baseTheme({".cm-md-textHighlight":{background:"rgba(255, 255, 0, 0.3)"}});g.MarkEdit.addExtension([x,m,d]);g.MarkEdit.addMarkdownConfig(u);
